<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  
  <script src="/assets/js/close_copy.js"></script>
  

  
  <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
  

  <title>Docker学习笔记</title>

  <link rel="shortcut icon" type="image/x-icon" href="/assets/private/icons/huangdayu.png" />
  <link rel="stylesheet" href="/assets/css/main.css" />
</head><body a="light">
    <main class="page-content" aria-label="Content">
      <div class="w">
        <a href="/">Back</a><article>
  
  <h1 class="post-header">Docker学习笔记</h1>

  <p class="post-meta">
    <time datetime="2019-03-01 22:47:50 +0800">2019-03-01</time>
  </p>
  
  <h1 id="什么是docker">什么是Docker</h1>
<hr />

<p>  我记得，我最早接触Docker的时候是2017年，吴树鑫老师的信息安全课上讲的，那个时候他推荐了CloudMan的教程。时间真TM快啊。<br />
  回到正题。<br />
  正确答案是：<strong>Docker 是世界领先的软件容器平台。</strong></p>

<h1 id="为什么用docker">为什么用Docker</h1>
<hr />

<h2 id="解决什么问题">解决什么问题</h2>

<p>  使得软件在任何环境中都能够始终如一地运行，不受外部系统环境差异的影响。</p>

<h2 id="解决方案">解决方案</h2>

<h3 id="虚拟机">虚拟机</h3>

<p>  虚拟机 (VM) 是一个物理硬件层抽象，用于将一台服务器变成多台服务器。</p>

<blockquote>
  <p>缺点：</p>
  <ul>
    <li>占用资源多</li>
    <li>操作麻烦</li>
    <li>启动缓慢</li>
  </ul>
</blockquote>

<h3 id="容器">容器</h3>

<p>  容器是一个应用层抽象，用于将代码和依赖资源打包在一起。多个容器可以在同一台机器上运行，共享操作系统内核，但各自作为独立的进程在用户空间中运行。容器镜像是轻量的、可执行的独立软件包，包含软件运行所需的所有内容：代码、运行时环境、系统工具、系统库和设置。</p>

<blockquote>
  <p>优势：</p>
  <ul>
    <li>启动快</li>
    <li>占用资源少</li>
    <li>命令操作简单</li>
  </ul>
</blockquote>

<h3 id="docker用途">Docker用途</h3>

<p>Docker 属于容器的一种封装，提供简单易用的容器使用接口。</p>

<ul>
  <li>提供一次性一致的测试，构建和部署环境；</li>
  <li>提供弹性操作服务；</li>
  <li>构建微服务架构。</li>
</ul>

<!-- more -->

<h1 id="怎么样用docker">怎么样用Docker</h1>
<hr />

<p><strong>常用命令</strong></p>

<h2 id="安装docker">安装Docker</h2>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>yum <span class="nb">install </span>docker
或者
apt <span class="nb">install </span>docker
</code></pre></div></div>

<h2 id="验证安装">验证安装</h2>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker verison
或者
docker info
</code></pre></div></div>

<h2 id="服务操作">服务操作</h2>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>service docker start（restart/stop/status）
</code></pre></div></div>
<p>或者</p>
<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>systemctl start（restart/stop/status） docker
</code></pre></div></div>

<h2 id="image操作">image操作</h2>

<p>image 是引用程序及其依赖的载体，image是二进制文件，在Docker中是通用的，可继承其他image，比较常用的image都是从<a href="https://hub.docker.com/">Docker Hub</a>拉取。</p>

<h3 id="拉取image">拉取image</h3>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker image pull <span class="s1">'imageName'</span>
或者
docker iamge pull <span class="s1">'pathName'</span>/<span class="s1">'imageName'</span>
</code></pre></div></div>

<h3 id="列出image">列出image</h3>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker image <span class="nb">ls</span>
</code></pre></div></div>

<h3 id="删除image">删除image</h3>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker image <span class="nb">rm</span> <span class="s1">'imageName'</span>
</code></pre></div></div>

<h3 id="运行image">运行image</h3>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker container run <span class="s1">'imageName'</span>
</code></pre></div></div>
<p>解释：先创建一个容器实例，然后运行image,会产生一个containID，如果本地没有改image，则自动从<a href="https://hub.docker.com/">Docker Hub</a>拉取。</p>

<h3 id="停止运行image">停止运行image</h3>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker container <span class="nb">kill</span> <span class="s1">'containID'</span>
</code></pre></div></div>

<h2 id="container操作">container操作</h2>

<p>container是image运行的载体，也就是容器实例。</p>

<h3 id="列出正在运行container">列出正在运行container</h3>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker container <span class="nb">ls</span>
</code></pre></div></div>

<h3 id="列出所有container">列出所有container</h3>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker container <span class="nb">ls</span> <span class="nt">-a</span>
</code></pre></div></div>

<h3 id="删除container">删除container</h3>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker container <span class="nb">rm</span> <span class="s1">'containerID'</span>
</code></pre></div></div>

<h3 id="启动container">启动container</h3>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker start <span class="s1">'containerID/containerName'</span>
</code></pre></div></div>

<h3 id="停止container">停止container</h3>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker stop <span class="s1">'containerID/containerName'</span>
</code></pre></div></div>

<h3 id="重启container">重启container</h3>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker restart <span class="s1">'containerID/containerName'</span>
</code></pre></div></div>

<h2 id="container与image的关系">container与image的关系</h2>

<p>镜像是文件, 容器是进程。 容器是基于镜像创建的, 即容器中的进程依赖于镜像中的文件, 这里的文件包括进程运行所需要的可执行文件， 依赖软件， 库文件， 配置文件等等…</p>

<h2 id="案例">案例</h2>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>root@izwz951e3fbtauq6d7ez9gz ~]# docker ps
CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS               NAMES
<span class="o">[</span>root@izwz951e3fbtauq6d7ez9gz ~]# docker image <span class="nb">ls
</span>REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE
<span class="o">[</span>root@izwz951e3fbtauq6d7ez9gz ~]# docker run <span class="nt">-d</span> <span class="nt">-p</span> 8001:80 httpd
Unable to find image <span class="s1">'httpd:latest'</span> locally
Trying to pull repository docker.io/library/httpd ... 
latest: Pulling from docker.io/library/httpd
6ae821421a7d: Pull <span class="nb">complete 
</span>0ceda4df88c8: Pull <span class="nb">complete 
</span>24f08eb4db68: Pull <span class="nb">complete 
</span>ddf4fc318081: Pull <span class="nb">complete 
</span>fc5812428ac0: Pull <span class="nb">complete 
</span>Digest: sha256:5e7992fcdaa214d5e88c4dfde274befe60d5d5b232717862856012bf5ce31086
Status: Downloaded newer image <span class="k">for </span>docker.io/httpd:latest
e760d48833f63f7f60688944798ce558e976e366cc3b7550a57c1dc680335a15
<span class="o">[</span>root@izwz951e3fbtauq6d7ez9gz ~]# docker ps
CONTAINER ID        IMAGE               COMMAND              CREATED             STATUS              PORTS                  NAMES
e760d48833f6        httpd               <span class="s2">"httpd-foreground"</span>   21 seconds ago      Up 20 seconds       0.0.0.0:8001-&gt;80/tcp   kickass_hypatia
<span class="o">[</span>root@izwz951e3fbtauq6d7ez9gz ~]# docker image <span class="nb">ls
</span>REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE
docker.io/httpd     latest              d3a13ec4a0f1        2 weeks ago         132 MB
<span class="o">[</span>root@izwz951e3fbtauq6d7ez9gz ~]# 
</code></pre></div></div>

<p><strong>操作结果</strong></p>

<p><img src="https://www.huangdayu.cn/assets/private/images/image-82.jpg" alt="操作结果" /></p>

<p><strong>命令解释</strong></p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker run <span class="nt">-d</span> <span class="nt">-p</span> 8001:80 httpd
</code></pre></div></div>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker run <span class="nt">--name</span> jenkins <span class="nt">-p</span> 8008:8080 docker.io/jenkins/jenkins
</code></pre></div></div>

<ul>
  <li><code class="language-plaintext highlighter-rouge">docker run</code>: 运行一个Docker容器</li>
  <li><code class="language-plaintext highlighter-rouge">-d</code>: 表示容器在后台运行</li>
  <li><code class="language-plaintext highlighter-rouge">-p 8001:80</code>: 表示将宿主机的8001端口映射到容器的80端口</li>
  <li><code class="language-plaintext highlighter-rouge">--name</code>: 设置容器名字</li>
  <li><code class="language-plaintext highlighter-rouge">httpd</code>: 表示容器名称或者镜像名称，首先查找本地容器，否则查找本地镜像，否则查找DockerHub云端仓库开放的镜像，没有容器则自动创建容器。</li>
  <li><code class="language-plaintext highlighter-rouge">CONTAINER ID</code>: 容器ID，对容器的操作可以根据ID进行。（start、restart、stop、rm）</li>
  <li><code class="language-plaintext highlighter-rouge">IMAGE ID</code>: 镜像ID，和容器ID是一样的属性</li>
  <li><code class="language-plaintext highlighter-rouge">PORTS</code>: 容器端口映射关系</li>
  <li><code class="language-plaintext highlighter-rouge">NAMES</code>: 容器名称，不指定则随机分配。</li>
  <li><code class="language-plaintext highlighter-rouge">REPOSITORY</code>: 镜像来源，可以是本地，也可以是云端仓库</li>
</ul>

<h2 id="dockerfile">Dockerfile</h2>

<p>Dockerfile是镜像的描述文件，是YAML标准格式的配置文件，定义了如何构建容器。关于Dockerfile的内容再另外写博文。</p>

<h2 id="docker容器命令">Docker容器命令</h2>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker <span class="nt">--help</span>
</code></pre></div></div>

<p>有关命令的详细信息，请运行“ Docker 命令 –help ”。</p>

<h3 id="选项参数">选项参数</h3>

<table>
  <thead>
    <tr>
      <th>选项</th>
      <th>类型</th>
      <th>说明</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>–config</td>
      <td>string</td>
      <td>客户端配置文件的位置 (default”/root/.docker”)</td>
    </tr>
    <tr>
      <td>-D, –debug</td>
      <td> </td>
      <td>启用调试模式</td>
    </tr>
    <tr>
      <td>–help</td>
      <td> </td>
      <td>打印使用方法</td>
    </tr>
    <tr>
      <td>-H, –host</td>
      <td>list</td>
      <td>连接到的守护程序套接字</td>
    </tr>
    <tr>
      <td>-l, –log-level</td>
      <td>string</td>
      <td>设置日志记录级别(“debug”/”info”/”warn”/”error”/”fatal”)(default “info”)</td>
    </tr>
    <tr>
      <td>–tls</td>
      <td> </td>
      <td>使用TLS  ; implied by –tlsverify</td>
    </tr>
    <tr>
      <td>–tlscacert</td>
      <td>string</td>
      <td>仅由本ca签署的信任证书(default”/root/.docker/ca.pem”)</td>
    </tr>
    <tr>
      <td>–tlscert</td>
      <td>string</td>
      <td>TLS证书文件路径(default”/root/.docker/cert.pem”)</td>
    </tr>
    <tr>
      <td>–tlskey</td>
      <td>string</td>
      <td>TLS密钥文件的路径(default “/root/.docker/key.pem”)</td>
    </tr>
    <tr>
      <td>–tlsverify</td>
      <td> </td>
      <td>使用TLS并验证远程</td>
    </tr>
    <tr>
      <td>-v, –version</td>
      <td> </td>
      <td>打印版本信息并退出</td>
    </tr>
  </tbody>
</table>

<h3 id="管理命令">管理命令</h3>

<table>
  <thead>
    <tr>
      <th>命令</th>
      <th>说明</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>config</td>
      <td>管理Docker 配置</td>
    </tr>
    <tr>
      <td>container</td>
      <td>管理容器</td>
    </tr>
    <tr>
      <td>image</td>
      <td>管理图像</td>
    </tr>
    <tr>
      <td>network</td>
      <td>管理网络</td>
    </tr>
    <tr>
      <td>node</td>
      <td>管理群集节点</td>
    </tr>
    <tr>
      <td>plugin</td>
      <td>管理插件</td>
    </tr>
    <tr>
      <td>secret</td>
      <td>管理Docker秘钥</td>
    </tr>
    <tr>
      <td>service</td>
      <td>管理服务</td>
    </tr>
    <tr>
      <td>stack</td>
      <td>管理 Docker 堆栈</td>
    </tr>
    <tr>
      <td>swarm</td>
      <td>管理集群</td>
    </tr>
    <tr>
      <td>system</td>
      <td>管理Docker</td>
    </tr>
    <tr>
      <td>volume</td>
      <td>管理Docker卷</td>
    </tr>
  </tbody>
</table>

<h3 id="控制命令">控制命令</h3>

<table>
  <thead>
    <tr>
      <th>命令</th>
      <th>说明</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>attach</td>
      <td>将本地标准输入、输出和错误流附加到运行的容器</td>
    </tr>
    <tr>
      <td>build</td>
      <td>从Dockerfile构建镜像</td>
    </tr>
    <tr>
      <td>commit</td>
      <td>将已经修改的容器镜像保存为新镜像</td>
    </tr>
    <tr>
      <td>cp</td>
      <td>在容器和本地文件系统之间复制文件/文件夹</td>
    </tr>
    <tr>
      <td>create</td>
      <td>创建新容器</td>
    </tr>
    <tr>
      <td>diff</td>
      <td>检查容器文件系统上文件或目录的更改</td>
    </tr>
    <tr>
      <td>events</td>
      <td>从服务器获取实时事件</td>
    </tr>
    <tr>
      <td>exec</td>
      <td>在正在运行的容器中运行命令</td>
    </tr>
    <tr>
      <td>export</td>
      <td>将容器的文件系统导出为tar压缩包</td>
    </tr>
    <tr>
      <td>history</td>
      <td>显示历史镜像</td>
    </tr>
    <tr>
      <td>images</td>
      <td>镜像列表</td>
    </tr>
    <tr>
      <td>import</td>
      <td>从容器中导入并创建新的系统镜像</td>
    </tr>
    <tr>
      <td>info</td>
      <td>显示系统范围内的信息</td>
    </tr>
    <tr>
      <td>inspect</td>
      <td>返回Docker对象的底层信息</td>
    </tr>
    <tr>
      <td>kill</td>
      <td>杀死一个或多个正在运行的容器</td>
    </tr>
    <tr>
      <td>load</td>
      <td>从一个tar压缩文件或标准输入加载图像</td>
    </tr>
    <tr>
      <td>login</td>
      <td>登录到Docker注册表</td>
    </tr>
    <tr>
      <td>logout</td>
      <td>退出Docker</td>
    </tr>
    <tr>
      <td>logs</td>
      <td>获取容器的日志</td>
    </tr>
    <tr>
      <td>pause</td>
      <td>在一个或多个容器中暂停所有进程</td>
    </tr>
    <tr>
      <td>port</td>
      <td>列出容器的端口映射或特定映射</td>
    </tr>
    <tr>
      <td>ps</td>
      <td>容器列表</td>
    </tr>
    <tr>
      <td>pull</td>
      <td>从注册表中提取图像或存储库</td>
    </tr>
    <tr>
      <td>push</td>
      <td>将图像或存储库推送到注册表</td>
    </tr>
    <tr>
      <td>rename</td>
      <td>重命名容器</td>
    </tr>
    <tr>
      <td>restart</td>
      <td>重新启动一个或多个容器</td>
    </tr>
    <tr>
      <td>rm</td>
      <td>删除一个或多个容器container</td>
    </tr>
    <tr>
      <td>rmi</td>
      <td>删除一个或多个图像images</td>
    </tr>
    <tr>
      <td>run</td>
      <td>在新容器中运行命令</td>
    </tr>
    <tr>
      <td>save</td>
      <td>将一个或多个图像保存到TAR归档文件中</td>
    </tr>
    <tr>
      <td>search</td>
      <td>从 Docker Hub搜索镜像</td>
    </tr>
    <tr>
      <td>start</td>
      <td>启动一个或多个已停止的容器</td>
    </tr>
    <tr>
      <td>stats</td>
      <td>显示容器资源使用率统计的动态流</td>
    </tr>
    <tr>
      <td>stop</td>
      <td>停止一个或多个正在运行的容器</td>
    </tr>
    <tr>
      <td>tag</td>
      <td>创建tag压缩 TARGET_IMAGE 指向SOURCE_IMAGE</td>
    </tr>
    <tr>
      <td>top</td>
      <td>显示容器中运行的线程</td>
    </tr>
    <tr>
      <td>unpause</td>
      <td>取消所有一个或多个容器的进程的暂停</td>
    </tr>
    <tr>
      <td>update</td>
      <td>更新一个或多个容器的配置</td>
    </tr>
    <tr>
      <td>version</td>
      <td>显示Docker 版本信息</td>
    </tr>
    <tr>
      <td>wait</td>
      <td>等到一个或多个容器停止，然后打印他们的退出代码</td>
    </tr>
  </tbody>
</table>

<h1 id="参考文献">参考文献</h1>
<hr />

<p><a href="https://docs.docker-cn.com/engine/installation/">Docker官方中文文档</a><br />
<a href="http://www.ruanyifeng.com/blog/2018/02/docker-tutorial.html">Docker入门教程</a><br />
<a href="https://www.cnblogs.com/CloudMan6/tag/Docker/default.html?page=9">每天5分钟玩转Docker容器技术</a></p>


</article><br/>
<br/>
<p style="display: block;text-align:center;">©2012-2022 huangdayu.cn(大鱼叔叔的博客) 版权所有，未经授权，不得转载。</p>
<br/>
<a style="display: block;text-align:right;" href="/">Back</a>
      </div>
    </main>
  </body>
</html>