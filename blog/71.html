<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  
  <script src="/assets/js/close_copy.js"></script>
  

  
  <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
  

  <title>集群架构设计简述</title>

  <link rel="shortcut icon" type="image/x-icon" href="/assets/private/icons/huangdayu.png" />
  <link rel="stylesheet" href="/assets/css/main.css" />

   <link rel="stylesheet" href="/assets/css/rouge.css" />
</head><body a="light">
    <main class="page-content" aria-label="Content">
      <div class="w">
        <a href="/">博客首页</a><article>
  
  <h1 class="post-header">集群架构设计简述</h1>

  <p class="post-meta">
    <time datetime="2024-01-08 00:00:00 +0800">2024-01-08</time>
  </p>
  
  <p>  三高架构，你即使没有设计过，也曾听到过，或者再面试造航母时被面试官问到过，所以，作为高级软件工程师，它是你所必须要掌握的能力。</p>

<p>  三高即是：高性能要求系统能够快速响应用户的请求，高可用要求保证系统的稳定性和可靠性，高扩展要求能够不断的扩展系统的能力。满足上述要求，便能够说你设计的系统是一个三高系统。另外，一个优秀的系统一定是兼顾安全性和可维护性的，以便在系统出现问题时能够及时进行调试和修复。</p>

<p>  要想达到上述目标，单节点提供服务连最起码的高可用都做不到，所以答案必然是多节点组成的服务集群。</p>

<p>  所谓集群，是指由多台计算机通过网络连接组成的一个共享资源环境，这些计算机协同工作以提供更高的计算能力、更高的可用性和容错性。在一个集群中，每个计算机节点都可以独立地处理任务，也可以通过协同工作来实现任务的分布式处理。集群可以根据需要动态增加或减少节点，实现资源的弹性分配。以下是几种常见的集群系统架构设计方式：</p>

<ol>
  <li>主备式集群（Active/Passive Cluster）：主备式集群包括一个主节点和一个或多个备节点。主节点负责处理请求和执行操作，并将数据变更同步到备节点，而备节点处于待命状态，当主节点发生故障时，备节点会接管主节点的工作，并成为新的主节点。
    <ul>
      <li>架构简单，主备之间只需要数据同步，保证了高可用性和容错性。</li>
      <li>备用节点造成一定的资源浪费。</li>
      <li>主备切换需要依赖其他服务，如Redis的哨兵节点。</li>
    </ul>
  </li>
  <li>主从式集群（Master/Slave Cluster）：主从式集群中有一个主节点和多个从节点。主节点负责接收和处理请求，并将数据同步到从节点。从节点则负责复制主节点的数据，并可用于读取操作。主从式集群通常用于读多写少的场景，因为写操作只能在主节点上执行，可能存在性能瓶颈。
    <ul>
      <li>适用于数据库系统等需要读写分离的场景。</li>
      <li>读写操作哪个节点需要客户端自行判断。</li>
      <li>主从同步延迟，也会造成部分数据丢失。</li>
    </ul>
  </li>
  <li>主主式集群（Active/Active Cluster）：主主式集群中有多个主节点，每个主节点都可以独立地处理请求和执行操作，所有节点都同时承担主节点和从节点的角色。主主式集群实现了负载均衡和容错性，允许多个节点同时对外提供服务。主主式集群通常适用于读写操作都比较频繁的场景，因为每个节点都能够处理请求，提高了系统的整体处理能力。
    <ul>
      <li>常用于分布式系统和大规模应用，读写都较为频繁，双向复制的场景。</li>
      <li>存在数据同步延迟，数据重复，数据覆盖等问题。</li>
    </ul>
  </li>
  <li>分片式集群（Sharding Cluster）：将数据按照某种规则分散存储在多个节点上，每个节点只负责部分数据。分片模式可以提高系统的存储容量和读写性能。通常情况下，分片是根据某种规则将数据划分为多个逻辑片段，比如基于数据的范围、哈希值或者其他分片策略。每个分片都有自己的独立存储空间和处理能力，并能够独立地执行读写操作。为了使分片式集群正常工作，通常还需要引入一个协调节点（Coordinator Node）或者元数据节点（Metadata Node），负责跟踪数据的分片位置、管理分片的迁移和路由请求等。
    <ul>
      <li>常用于大型数据全文检索系统中。</li>
      <li>复杂度更高，需要引入更多角色的节点才能实现。</li>
    </ul>
  </li>
</ol>

<p>  毫无疑问，任何一种技术方案，有利必有弊。在集群架构下，需要解决以下几个问题：</p>

<ol>
  <li>负载均衡：使用负载均衡器来分发请求，确保每个节点负载均衡，避免单个节点过载。常见的负载均衡算法有轮询、加权轮询、最少连接、一致性哈希等。</li>
  <li>高可用性：通过使用冗余节点和故障切换机制来确保系统的高可用性。可以使用主备模式或主从模式来实现故障切换，当主节点出现故障时，备用节点会自动接管服务。</li>
  <li>数据一致性：在集群中使用数据复制和同步技术，确保数据的一致性和可靠性。常见的技术包括主从复制、多主复制和基于日志的复制。</li>
  <li>容错性：使用冗余节点和数据备份来增加系统的容错性。如果某个节点发生故障，系统可以自动切换到备用节点，并且数据备份可以恢复丢失的数据。</li>
  <li>监控和管理：使用监控工具和管理系统来实时监测集群的状态和性能。可以使用自动化工具来实现节点的自动扩展和缩减，以适应负载变化，和及时发现并解决潜在问题。</li>
  <li>安全性：确保集群的安全性，包括访问控制、身份认证和数据加密等。可以使用防火墙、VPN、SSL等技术来增强系统的安全性。</li>
  <li>扩展性：通过增加节点来实现系统的扩展性。可以根据负载的增加或减少来动态调整集群的规模。</li>
  <li>弹性计算：使用云计算平台提供的弹性资源来构建集群，可以根据需求自动调整资源的规模。</li>
  <li>通信稳定性：保证网络通信的稳定性和可靠性。采用网络优化、心跳检测、数据冗余、重试机制、流量控制、错误纠正等方法解决。</li>
</ol>

<p>  软件行业中，更高的要求意味着更复杂的设计，解决一个问题有时也意味着引来更多的问题，简单，恰到好处的架构设计才能使软件的成本更低，更加容易理解，更加容易演进，迭代和维护。</p>

<p>  现在的软件系统设计者，开口就是高性能、高可用、高扩展，可是能够真正有此需求的项目屈指可数，脱离业务的架构设计更是比比皆是，虽说追求更高大上的技术本身并没有错，但必须认识到符合实际情况，满足实际需求的架构设计便足矣。</p>

<p align="right">开元4721年冬月廿九 广州黄埔</p>
<br/>
<a style="display: block;text-align:right;" href="/">博客首页</a>
<br/>
<p style="display: block;text-align:center;">©2012-2023 huangdayu.cn(大鱼叔叔的博客) 版权所有，未经授权，不得转载。</p>
<br/></article>


      </div>
    </main>
  </body>
</html>