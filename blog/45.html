<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  
  <script src="/assets/js/close_copy.js"></script>
  

  
  <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
  

  <title>俯瞰微服务</title>

  <link rel="shortcut icon" type="image/x-icon" href="/assets/private/icons/huangdayu.png" />
  <link rel="stylesheet" href="/assets/css/main.css" />
</head><body a="light">
    <main class="page-content" aria-label="Content">
      <div class="w">
        <a href="/">博客首页</a><article>
  
  <h1 class="post-header">俯瞰微服务</h1>

  <p class="post-meta">
    <time datetime="2020-11-25 00:02:41 +0800">2020-11-25</time>
  </p>
  
  <h2 id="前言">前言</h2>

<p>  本文旨在让阅读者对微服务（分布式架构）以及微服务框架<code class="language-plaintext highlighter-rouge">SpringCloud</code>建立全面的认知。</p>

<!-- more -->

<h2 id="为何需要微服务">为何需要微服务</h2>

<p>  当产品的需求越来越多和要求越来越高的时候，传统的单体服务随着代码量和功能的增加，使得业务逻辑变得复杂，新增新的功能也越发困难，遇到需求峰值是，必须横向扩展整体服务，加上紧密耦合的情况下，当出现局部异常时影响会被扩大，最终也使得项目难以维护。</p>

<p>  微服务的出现，显然是为了解决这写问题。微服务将之前的单体服务拆分成多个领域服务，每个服务之间建立通信，每一个服务都可以独立运行，独立对外提供服务。每一个团队负责组织服务的开发与维护，以满足持续集成，快速交付，灵活扩展，弹性伸缩，低耦合度，高度复用的要求。</p>

<h2 id="微服务功能架构">微服务功能架构</h2>

<script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>

<script>mermaid.initialize({startOnLoad:true});</script>

<div class="mermaid">

graph LR
Author(大鱼叔叔)
A{微服务}
B[功能架构]
C[服务注册]
F[服务通信]
D[服务配置]
E[服务治理]
G[服务网关]


A --&gt;|定义|B
B --&gt; C
B --&gt; F
B --&gt; D
B --&gt; E
B --&gt; G


C --&gt; C1[服务注册]
C --&gt; C2[服务发现]
C --&gt; C4[事件通知]

F --&gt; F1[远程调用]
F --&gt; F2[消息中间件]

D --&gt; D1[配置编辑]
D --&gt; D2[配置发布]
D --&gt; D3[配置管理]

D2 --&gt; D21[灰度发布]
D2 --&gt; D22[全量发布]
D2 --&gt; D23[指定发布]

E --&gt; E1[服务运维]
E --&gt; E3[服务查询]
E --&gt; E4[服务保障]
E --&gt; E5[任务调度]
E --&gt; E6[事务处理]
E --&gt; E7[服务监控]

E1 --&gt; E1d[服务部署]
E1 --&gt; E1a[服务测试]
E1 --&gt; E1b[服务上线]
E1 --&gt; E1c[服务下线]

E1a --&gt; E1a1[集成测试 &amp; 全链路测试]
E1a --&gt; E1a2[单元测试]

E1b --&gt; E1b1[金丝雀发布]
E1b --&gt; E1b2[滚动式发布]
E1b --&gt; E1b3[蓝绿发布]
E1b --&gt; E1b4[A/B测试]

E1c --&gt; E1ca[无损下线]
E1c --&gt; E1cb[优雅停机]

E1d --&gt; E1da[自动化]
E1d --&gt; E1db[容器]

E3 --&gt; E31[信息查询]
E3 --&gt; E32[接口查询]

E4 --&gt; E41[熔断重试]
E4 --&gt; E42[限流舱壁]

E5 --&gt; E51[任务编排]
E5 --&gt; E52[存储调度]
E5 --&gt; E53[执行注册]

E6 --&gt; E61[事务协调]
E6 --&gt; E62[事务管理]
E6 --&gt; E63[资源管理]

E7 --&gt; E71[指标监控]
E7 --&gt; E72[日志收集]
E7 --&gt; E73[调用追踪]

G --&gt; G1[服务路由]
G --&gt; G2[负载均衡]
G --&gt; G3[服务权鉴]

G1 --&gt; G1a[过滤]
G1 --&gt; G1b[转发]
G1 --&gt; G1c[重定向] 
G1 --&gt; G1d[拦截] 

G2 --&gt; G2a[轮询]
G2 --&gt; G2b[随机]
G2 --&gt; G2c[一致性哈希]
G2 --&gt; G2d[权重]
G2 --&gt; G2e[最小连接数]

G3 --&gt; G3a[令牌]
G3 --&gt; G3b[会话]
G3 --&gt; G3c[秘钥] 

</div>

<h2 id="微服务技术架构">微服务技术架构</h2>

<div class="mermaid">

graph LR
Author(大鱼叔叔)
A{微服务}
B[Spring Cloud 技术架构]
C[服务注册]
H[服务通信]
D[服务配置]
E[服务治理]
G[服务网关]



A --&gt;|实践| B
B --&gt; C
B --&gt; H
B --&gt; D
B --&gt; E
B --&gt; G


C --&gt; C1[Eureka]
C --&gt; C2[Zookeeper]
C --&gt; C3[Consul]
C --&gt; C4[Etcd]
C --&gt; C5[Nacos]
C --&gt; C6[CoreDNS]

H --&gt; H1[RPC]
H --&gt; H2[MQ]

H1 --&gt; H1a[Feign]
H1 --&gt; H1b[gRPC]
H1 --&gt; H1c[Dubbo]
H1 --&gt; H1d[RSocket]

H2 --&gt; H2a[Kafka]
H2 --&gt; H2b[RabbitMQ]
H2 --&gt; H2d[ActiveMQ]

D --&gt; D1[Spring Cloud Config &amp; Bus]
D --&gt; D2[Apollo]
D --&gt; D3[Nacos]
D --&gt; D4[Consul]


E --&gt; E1[服务运维]
E --&gt; E3[服务查询]
E --&gt; E4[服务保障]
E --&gt; E5[任务调度]
E --&gt; E6[事务处理]
E --&gt; E7[服务监控]

E1 --&gt; E1d[服务部署]
E1 --&gt; E1a[服务测试]
E1 --&gt; E1b[服务发布]
E1 --&gt; E1c[服务下线]

E1a --&gt; E1a1[Junit]
E1a --&gt; E1a2[Postman]

E1b --&gt; E1b1[Nepxion Discovery]
E1b --&gt; E1b2[Ribbon]


E1c --&gt; E1c1a[Spring Boot Actuator]
E1c --&gt; E1c1b[Nacos]
E1c --&gt; E1c1c[Shutdown Hook]
E1c --&gt; E1c1d[Spring Boot Graceful]

E1d --&gt; E1da[Docker]
E1d --&gt; E1db[Kubernetes]
E1d --&gt; E1dc[Jenkins &amp; WebHook]
E1d --&gt; E1dd[OpenKruise]

E3 --&gt; E31[Spring Boot Admin]

E4 --&gt; E41[Hystrix]
E4 --&gt; E42[Sentinel]
E4 --&gt; E43[Resilience4j]

E5 --&gt; E51[ElasticJob]
E5 --&gt; E52[Quartz]
E5 --&gt; E53[XXL-JOB]
E5 --&gt; E54[PowerJob]
E5 --&gt; E55[Spring Cloud Task]

E6 --&gt; E61[Seata]
E6 --&gt; E62[TCC-Transaction]
E6 --&gt; E63[Happylifeplat-TCC]

E7 --&gt; E71[指标监控]
E7 --&gt; E72[日志收集]
E7 --&gt; E73[调用追踪]


E71 --&gt; E71a[Turbine &amp; Hystrix]
E71 --&gt; E71b[Spring Boot Admin]
E71 --&gt; E71c[Prometheus &amp; Grafana]

E72 --&gt; E72a[Elasticsearch Logstash Kibana]
E72 --&gt; E72b[Sentry]
E72 --&gt; E72c[Spring Cloud Sleuth]

E73 --&gt; E73a[SkyWalking]
E73 --&gt; E73b[Zipkin]
E73 --&gt; E73c[CAT]

G --&gt; Ga[网关]
G --&gt; Gb[权鉴]
G --&gt; Gc[负载均衡]

Ga --&gt; G1[Spring Cloud Gateway]
Ga --&gt; G2[Kong]
Ga --&gt; G3[ApiSix]
Ga --&gt; G4[Traefik]
Ga --&gt; G5[Ambassador]
Ga --&gt; G6[Tyk]
Ga --&gt; G7[GoKu]
Ga --&gt; G8[Zuul]


Gb --&gt; Gb1[OAuth2]
Gb --&gt; Gb2[Session]
Gb --&gt; Gb3[Cookie] 

Gc --&gt; Gc1[Ribbon]
Gc --&gt; Gc2[Srping cloud Loadbalancer]

</div>

<h2 id="总结">总结</h2>

<p>  当然，微服务的出现，也带来了一些问题，比如增加研发投入的成本和资源成本，增加整体项目的复杂度，问题的排查，单元测试等也变得越发困难。为了解决问题，不得不引入或开发一些功能组件，有边车模式的，有强侵入式的，有基于注解的，这些组件的引入无疑使得项目愈加复杂。</p>

<p>  所以，有得必有失，在技术日新月异的今天，切莫盲目跟随，结合团队自身条件和产品需求，实用型架构才是好架构。</p>
<br/>
<a style="display: block;text-align:right;" href="/">博客首页</a>
<br/>
<p style="display: block;text-align:center;">©2012-2023 huangdayu.cn(大鱼叔叔的博客) 版权所有，未经授权，不得转载。</p>
<br/></article>


      </div>
    </main>
  </body>
</html>