<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  
  <script src="/assets/js/close_copy.js"></script>
  

  
  <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
  

  <title>Ajax学习笔记</title>

  <link rel="shortcut icon" type="image/x-icon" href="/assets/private/icons/huangdayu.png" />
  <link rel="stylesheet" href="/assets/css/main.css" />
</head><body a="light">
    <main class="page-content" aria-label="Content">
      <div class="w">
        <a href="/">Back</a><article>
  
  <h1 class="post-header">Ajax学习笔记</h1>

  <p class="post-meta">
    <time datetime="2018-12-21 05:30:34 +0800">2018-12-21</time>
  </p>
  
  <h1 id="参数说明">参数说明</h1>

<table>
  <thead>
    <tr>
      <th>参数</th>
      <th>说明</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>async</td>
      <td>布尔值，表示请求是否异步处理。默认是 true。</td>
    </tr>
    <tr>
      <td>beforeSend(xhr)</td>
      <td>发送请求前运行的函数。</td>
    </tr>
    <tr>
      <td>cache</td>
      <td>布尔值，表示浏览器是否缓存被请求页面。默认是 true。</td>
    </tr>
    <tr>
      <td>complete(xhr,status)</td>
      <td>请求完成时运行的函数（在请求成功或失败之后均调用，即在 success 和 error 函数之后）。</td>
    </tr>
    <tr>
      <td>contentType</td>
      <td>发送数据到服务器时所使用的内容类型。默认是：”application/x-www-form-urlencoded”。</td>
    </tr>
    <tr>
      <td>context</td>
      <td>为所有 AJAX 相关的回调函数规定 “this” 值。</td>
    </tr>
    <tr>
      <td>data</td>
      <td>规定要发送到服务器的数据。</td>
    </tr>
    <tr>
      <td>dataFilter(data,type)</td>
      <td>用于处理 XMLHttpRequest 原始响应数据的函数。</td>
    </tr>
    <tr>
      <td>dataType</td>
      <td>预期的服务器响应的数据类型。</td>
    </tr>
    <tr>
      <td>error(xhr,status,error)</td>
      <td>如果请求失败要运行的函数。</td>
    </tr>
    <tr>
      <td>global</td>
      <td>布尔值，规定是否为请求触发全局 AJAX 事件处理程序。默认是 true。</td>
    </tr>
    <tr>
      <td>ifModified</td>
      <td>布尔值，规定是否仅在最后一次请求以来响应发生改变时才请求成功。默认是 false。</td>
    </tr>
    <tr>
      <td>jsonp</td>
      <td>在一个 jsonp 中重写回调函数的字符串。</td>
    </tr>
    <tr>
      <td>jsonpCallback</td>
      <td>在一个 jsonp 中规定回调函数的名称。</td>
    </tr>
    <tr>
      <td>password</td>
      <td>规定在 HTTP 访问认证请求中使用的密码。</td>
    </tr>
    <tr>
      <td>processData</td>
      <td>布尔值，规定通过请求发送的数据是否转换为查询字符串。默认是 true。</td>
    </tr>
    <tr>
      <td>scriptCharset</td>
      <td>规定请求的字符集。</td>
    </tr>
    <tr>
      <td>success(result,status,xhr)</td>
      <td>当请求成功时运行的函数。</td>
    </tr>
    <tr>
      <td>timeout</td>
      <td>设置本地的请求超时时间（以毫秒计）。</td>
    </tr>
    <tr>
      <td>traditional</td>
      <td>布尔值，规定是否使用参数序列化的传统样式。</td>
    </tr>
    <tr>
      <td>type</td>
      <td>规定请求的类型（GET 或 POST）。</td>
    </tr>
    <tr>
      <td>url</td>
      <td>规定发送请求的 URL。默认是当前页面。</td>
    </tr>
    <tr>
      <td>username</td>
      <td>规定在 HTTP 访问认证请求中使用的用户名。</td>
    </tr>
    <tr>
      <td>xhr</td>
      <td>用于创建 XMLHttpRequest 对象的函数。</td>
    </tr>
  </tbody>
</table>

<!-- more -->

<h1 id="form的提交">Form的提交</h1>

<h2 id="html">HTML</h2>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"oauth"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"oauth_logo"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;img</span> <span class="na">src=</span><span class="s">"/oauth/image/oauth.png"</span><span class="nt">&gt;&lt;/div&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"oauth_logo_title"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">"str"</span><span class="nt">&gt;</span>授权第三方获取您的
      <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">"str1"</span> <span class="na">onclick=</span><span class="s">"openData()"</span><span class="nt">&gt;</span>开放数据<span class="nt">&lt;/span&gt;&lt;/span&gt;</span>
    <span class="nt">&lt;span</span> <span class="na">th:text=</span><span class="s">"${explain}"</span><span class="nt">&gt;&lt;/span&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"oauth_login"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;form</span> <span class="na">id=</span><span class="s">"oauth_from_id"</span> <span class="na">method=</span><span class="s">"POST"</span> <span class="na">name=</span><span class="s">"oauth_from"</span> <span class="na">enctype=</span><span class="s">"application/x-www-form-urlencoded"</span> <span class="na">target=</span><span class="s">"oauthLoginFrame"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"oauth_login_1"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">required=</span><span class="s">"required"</span> <span class="na">placeholder=</span><span class="s">"请输入登录账号"</span> <span class="na">name=</span><span class="s">"userName"</span> <span class="na">id=</span><span class="s">"username"</span><span class="nt">&gt;&lt;/input&gt;</span>
      <span class="nt">&lt;/div&gt;</span>
      <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"oauth_login_1 oauth_login_2"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"password"</span> <span class="na">required=</span><span class="s">"required"</span> <span class="na">placeholder=</span><span class="s">"请输入登录密码"</span> <span class="na">name=</span><span class="s">"passWord"</span> <span class="na">id=</span><span class="s">"password"</span><span class="nt">&gt;&lt;/input&gt;</span>
      <span class="nt">&lt;/div&gt;</span>
      <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"oauth_login_button"</span> <span class="na">id=</span><span class="s">"oauth_login_button"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;button</span> <span class="na">class=</span><span class="s">"oauth_login_button_1"</span> <span class="na">id=</span><span class="s">"oauth_login_button"</span> <span class="na">type=</span><span class="s">"submit"</span> <span class="na">onclick=</span><span class="s">"oauthLogin()"</span><span class="nt">&gt;</span>登录并授权<span class="nt">&lt;/button&gt;</span>
        <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"oauth_login_button_2"</span><span class="nt">&gt;</span>
          <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">"oauth_login_button_2_1"</span><span class="nt">&gt;</span>下载APP与注册账户,
            <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"#"</span> <span class="na">onclick=</span><span class="s">"loadAPP()"</span><span class="nt">&gt;</span>点击这里。<span class="nt">&lt;/a&gt;&lt;/span&gt;</span>
        <span class="nt">&lt;/div&gt;</span>
      <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;/form&gt;</span>
    <span class="nt">&lt;iframe</span> <span class="na">id=</span><span class="s">"oauthLoginFrame"</span> <span class="na">name=</span><span class="s">"oauthLoginFrame"</span> <span class="na">style=</span><span class="s">"display:none"</span><span class="nt">&gt;&lt;/iframe&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</code></pre></div></div>

<h2 id="ajax提交form">Ajax提交Form</h2>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">ajaxFlag</span><span class="p">;</span>
<span class="kd">function</span> <span class="nx">oauthLogin2</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">ajaxFlag</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span><span class="p">;</span> <span class="c1">//终止上一条请求，防止重复请求</span>
    <span class="p">}</span>
    <span class="kd">var</span> <span class="nx">loginForm</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="dl">'</span><span class="s1">#oauth_from_id</span><span class="dl">'</span><span class="p">);</span>
    <span class="nx">ajaxFlag</span> <span class="o">=</span> <span class="nx">loginForm</span><span class="p">.</span><span class="nx">submit</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">ev</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
            <span class="na">async</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
            <span class="c1">//关闭一步请求</span>
            <span class="na">type</span><span class="p">:</span> <span class="nx">loginForm</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="dl">'</span><span class="s1">method</span><span class="dl">'</span><span class="p">),</span>
            <span class="na">url</span><span class="p">:</span> <span class="nx">loginForm</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="dl">'</span><span class="s1">action</span><span class="dl">'</span><span class="p">),</span>
            <span class="na">dataType</span><span class="p">:</span> <span class="dl">"</span><span class="s2">json</span><span class="dl">"</span><span class="p">,</span>
            <span class="na">contentType</span><span class="p">:</span> <span class="nx">loginForm</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="dl">'</span><span class="s1">enctype</span><span class="dl">'</span><span class="p">),</span>
            <span class="na">data</span><span class="p">:</span> <span class="nx">loginForm</span><span class="p">.</span><span class="nx">serialize</span><span class="p">(),</span>
            <span class="na">xhrFields</span><span class="p">:</span> <span class="p">{</span>
                <span class="na">withCredentials</span><span class="p">:</span> <span class="kc">true</span>
            <span class="p">},</span>
            <span class="na">crossDomain</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
            <span class="c1">//发送请求前运行的函数</span>
            <span class="na">beforeSend</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">xhr</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">beforeSend-status：</span><span class="dl">"</span> <span class="o">+</span> <span class="nx">xhr</span><span class="p">.</span><span class="nx">status</span><span class="p">);</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">beforeSend-state:</span><span class="dl">"</span> <span class="o">+</span> <span class="nx">xhr</span><span class="p">.</span><span class="nx">readyState</span><span class="p">);</span>
            <span class="p">},</span>
            <span class="c1">//当请求成功时运行的函数</span>
            <span class="na">success</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">,</span> <span class="nx">status</span><span class="p">,</span> <span class="nx">xhr</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">success-result：</span><span class="dl">"</span> <span class="o">+</span> <span class="nx">result</span><span class="p">);</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">success-status：</span><span class="dl">"</span> <span class="o">+</span> <span class="nx">status</span><span class="p">);</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">success-xhr-status：</span><span class="dl">"</span> <span class="o">+</span> <span class="nx">xhr</span><span class="p">.</span><span class="nx">status</span><span class="p">);</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">success-xhr-state:</span><span class="dl">"</span> <span class="o">+</span> <span class="nx">xhr</span><span class="p">.</span><span class="nx">readyState</span><span class="p">);</span>
                <span class="kd">var</span> <span class="nx">code</span> <span class="o">=</span> <span class="nx">result</span><span class="p">.</span><span class="nx">code</span><span class="p">;</span>
                <span class="kd">var</span> <span class="nx">msg</span> <span class="o">=</span> <span class="nx">result</span><span class="p">.</span><span class="nx">msg</span><span class="p">;</span>
                <span class="kd">var</span> <span class="nx">des</span> <span class="o">=</span> <span class="nx">result</span><span class="p">.</span><span class="nx">des</span><span class="p">;</span>
                <span class="k">if</span> <span class="p">(</span><span class="mi">21333</span> <span class="o">==</span> <span class="nx">code</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">swal</span><span class="p">(</span><span class="dl">"</span><span class="s2">授权失败</span><span class="dl">"</span><span class="p">,</span> <span class="nx">des</span><span class="p">,</span> <span class="dl">"</span><span class="s2">error</span><span class="dl">"</span><span class="p">);</span>
                <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="mi">21319</span> <span class="o">==</span> <span class="nx">code</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">swal</span><span class="p">(</span><span class="dl">"</span><span class="s2">授权成功</span><span class="dl">"</span><span class="p">,</span> <span class="nx">des</span><span class="p">,</span> <span class="dl">"</span><span class="s2">success</span><span class="dl">"</span><span class="p">);</span>
                <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                    <span class="nx">swal</span><span class="p">(</span><span class="dl">"</span><span class="s2">授权失败</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">授权发生错误,请稍后重试！</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">error</span><span class="dl">"</span><span class="p">);</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="c1">//用于处理 XMLHttpRequest 原始响应数据的函数</span>
            <span class="na">dataFilter</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">,</span> <span class="nx">type</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">dataFilter-data：</span><span class="dl">"</span> <span class="o">+</span> <span class="nx">data</span><span class="p">);</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">dataFilter-type：</span><span class="dl">"</span> <span class="o">+</span> <span class="nx">type</span><span class="p">);</span>
            <span class="p">},</span>
            <span class="c1">//如果请求失败要运行的函数。</span>
            <span class="na">error</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">xhr</span><span class="p">,</span> <span class="nx">status</span><span class="p">,</span> <span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">error-xhr-status：</span><span class="dl">"</span> <span class="o">+</span> <span class="nx">xhr</span><span class="p">.</span><span class="nx">status</span><span class="p">);</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">error-xhr-state：</span><span class="dl">"</span> <span class="o">+</span> <span class="nx">xhr</span><span class="p">.</span><span class="nx">readyState</span><span class="p">);</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">error-status:</span><span class="dl">"</span> <span class="o">+</span> <span class="nx">status</span><span class="p">);</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">error-error:</span><span class="dl">"</span> <span class="o">+</span> <span class="nx">error</span><span class="p">);</span>
                <span class="kd">var</span> <span class="nx">url</span> <span class="o">=</span> <span class="nx">xhr</span><span class="p">.</span><span class="nx">getResponseHeader</span><span class="p">(</span><span class="dl">"</span><span class="s2">location</span><span class="dl">"</span><span class="p">);</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">error-url:</span><span class="dl">"</span> <span class="o">+</span> <span class="nx">url</span><span class="p">);</span>
            <span class="p">},</span>
            <span class="c1">//请求完成时运行的函数（在请求成功或失败之后均调用，即在 success 和 error 函数之后）</span>
            <span class="na">complete</span><span class="p">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">xhr</span><span class="p">,</span> <span class="nx">status</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">complete-xhr-status：</span><span class="dl">"</span> <span class="o">+</span> <span class="nx">xhr</span><span class="p">.</span><span class="nx">status</span><span class="p">);</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">complete-xhr-state:</span><span class="dl">"</span> <span class="o">+</span> <span class="nx">xhr</span><span class="p">.</span><span class="nx">readyState</span><span class="p">);</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">complete-status:</span><span class="dl">"</span> <span class="o">+</span> <span class="nx">status</span><span class="p">);</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">complete-url:</span><span class="dl">"</span> <span class="o">+</span> <span class="nx">xhr</span><span class="p">.</span><span class="nx">getResponseHeader</span><span class="p">(</span><span class="dl">"</span><span class="s2">Location</span><span class="dl">"</span><span class="p">));</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">complete-all-header:</span><span class="dl">"</span> <span class="o">+</span> <span class="nx">xhr</span><span class="p">.</span><span class="nx">getAllResponseHeaders</span><span class="p">());</span>
                <span class="k">if</span> <span class="p">((</span><span class="nx">xhr</span><span class="p">.</span><span class="nx">status</span> <span class="o">&gt;=</span> <span class="mi">300</span> <span class="o">&amp;&amp;</span> <span class="nx">xhr</span><span class="p">.</span><span class="nx">status</span> <span class="o">&lt;</span> <span class="mi">400</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">xhr</span><span class="p">.</span><span class="nx">status</span> <span class="o">!=</span> <span class="mi">304</span><span class="p">)</span> <span class="p">{</span>
                    <span class="c1">//重定向网址在响应头中，取出再执行跳转</span>
                    <span class="nb">window</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">href</span> <span class="o">=</span> <span class="nx">xhr</span><span class="p">.</span><span class="nx">getResponseHeader</span><span class="p">(</span><span class="dl">'</span><span class="s1">X-Redirect</span><span class="dl">'</span><span class="p">);</span>
                    <span class="nb">window</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">href</span> <span class="o">=</span> <span class="nx">xhr</span><span class="p">.</span><span class="nx">getResponseHeader</span><span class="p">(</span><span class="dl">'</span><span class="s1">Location</span><span class="dl">'</span><span class="p">);</span>
                <span class="p">}</span>
            <span class="p">},</span>
        <span class="p">});</span>
        <span class="nx">ev</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">();</span>
    <span class="p">});</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="iframe提交form">Iframe提交Form</h2>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">oauthLogin</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">$</span><span class="p">(</span><span class="dl">'</span><span class="s1">#oauth_login_button</span><span class="dl">'</span><span class="p">).</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">click</span><span class="dl">'</span><span class="p">,</span>
    <span class="kd">function</span><span class="p">(</span><span class="nx">XMLHttpRequest</span><span class="p">,</span> <span class="nx">textStatus</span><span class="p">,</span> <span class="nx">errorThrown</span><span class="p">,</span> <span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">timeSet</span> <span class="o">=</span> <span class="nx">setInterval</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="k">try</span> <span class="p">{</span>
                <span class="kd">var</span> <span class="nx">iframeObj</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">frames</span><span class="p">[</span><span class="dl">"</span><span class="s2">oauthLoginFrame</span><span class="dl">"</span><span class="p">].</span><span class="nb">document</span><span class="p">);</span>
                <span class="kd">var</span> <span class="nx">val</span> <span class="o">=</span> <span class="nx">iframeObj</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="dl">"</span><span class="s2">body</span><span class="dl">"</span><span class="p">).</span><span class="nx">find</span><span class="p">(</span><span class="dl">"</span><span class="s2">pre</span><span class="dl">"</span><span class="p">).</span><span class="nx">html</span><span class="p">();</span>
                <span class="k">if</span> <span class="p">(</span><span class="nx">val</span> <span class="o">!=</span> <span class="dl">""</span> <span class="o">&amp;&amp;</span> <span class="nx">val</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="dl">"</span><span class="s2">code</span><span class="dl">"</span><span class="p">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="nx">val</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="dl">"</span><span class="s2">msg</span><span class="dl">"</span><span class="p">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
                    <span class="kd">var</span> <span class="nx">successData</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">val</span><span class="p">);</span>
                    <span class="kd">var</span> <span class="nx">code</span> <span class="o">=</span> <span class="nx">successData</span><span class="p">.</span><span class="nx">code</span><span class="p">;</span>
                    <span class="kd">var</span> <span class="nx">msg</span> <span class="o">=</span> <span class="nx">successData</span><span class="p">.</span><span class="nx">msg</span><span class="p">;</span>
                    <span class="kd">var</span> <span class="nx">des</span> <span class="o">=</span> <span class="nx">successData</span><span class="p">.</span><span class="nx">des</span><span class="p">;</span>
                    <span class="k">if</span> <span class="p">(</span><span class="mi">21333</span> <span class="o">==</span> <span class="nx">code</span><span class="p">)</span> <span class="p">{</span>
                        <span class="nx">swal</span><span class="p">(</span><span class="dl">"</span><span class="s2">授权失败</span><span class="dl">"</span><span class="p">,</span> <span class="nx">des</span><span class="p">,</span> <span class="dl">"</span><span class="s2">error</span><span class="dl">"</span><span class="p">);</span>
                        <span class="nx">clearInterval</span><span class="p">(</span><span class="nx">timeSet</span><span class="p">);</span>
                        <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
                    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                        <span class="nx">swal</span><span class="p">(</span><span class="dl">"</span><span class="s2">授权成功</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">该第三方已可获得您的信息。</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">success</span><span class="dl">"</span><span class="p">);</span>
                        <span class="nx">clearInterval</span><span class="p">(</span><span class="nx">timeSet</span><span class="p">);</span>
                        <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
                    <span class="p">}</span>
                <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                    <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span> <span class="k">catch</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">},</span>
        <span class="mi">1000</span><span class="p">);</span>
    <span class="p">});</span>
<span class="p">}</span>
</code></pre></div></div>


</article><br/>
<br/>
<p style="display: block;text-align:center;">©2012-2022 huangdayu.cn(大鱼叔叔的博客) 版权所有，未经授权，不得转载。</p>
<br/>
<a style="display: block;text-align:right;" href="/">Back</a>
      </div>
    </main>
  </body>
</html>