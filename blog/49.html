<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  
  <script src="/assets/js/close_copy.js"></script>
  

  
  <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
  

  <title>关于灵活型架构的思考</title>

  <link rel="shortcut icon" type="image/x-icon" href="/assets/private/icons/huangdayu.png" />
  <link rel="stylesheet" href="/assets/css/main.css" />
</head><body a="light">
    <main class="page-content" aria-label="Content">
      <div class="w">
        <a href="/">Back</a><article>
  
  <h1 class="post-header">关于灵活型架构的思考</h1>

  <p class="post-meta">
    <time datetime="2021-03-12 00:00:00 +0800">2021-03-12</time>
  </p>
  
  <h2 id="前言">前言</h2>

<hr />

<blockquote class="blockquote-center">
<p style="font-size: 30px;text-align: center;">技术是手段，而非目的。</p>
</blockquote>

<p>  由于项目的需要，架构必须适应于不同资源，环境下的灵活部署，不同框架，中间件，组件下灵活适配。在实践过程中得出此篇文章。</p>

<!-- more -->

<h2 id="灵活架构的定义">灵活架构的定义</h2>

<hr />

<p>  架构，在物理模式上，分为<strong>集群模式</strong>和<strong>单机模式</strong>；在软件模式上，分为<strong>单体模式</strong>和<strong>分布式模式</strong>。很显然，所谓灵活，就是架构要通过高度自定义配置，灵活选择物理模式和软件模式。这种架构设计模式，对于小企业，小团队，简直就是架构的最理想状态。</p>

<p>  在我看来，灵活的架构由项目结构，动态配置，组件隔离3个部分组成，且看我娓娓道来。</p>

<h2 id="灵活的项目结构">灵活的项目结构</h2>

<hr />

<p>  灵活架构往往是从灵活的项目结构开始的。我认为项目结构的设计是开发者能力的一种体现，而且是最直接的体现。优秀的项目结构，能够让阅读者能够从中一眼看出架构设计。项目结构的设计一般有按技术、业务、应用、产品几种层次来设计。然而，如果只按这一种方式来设计结构，明显不合理，也不灵活。所以，项目应当是多种层次结合，由浅入深，循序渐进。以下是本人的一次<strong><code class="language-plaintext highlighter-rouge">AI-IOT</code></strong>项目按照领域驱动设计规范（<code class="language-plaintext highlighter-rouge">DDD</code>）设计项目结构的实践：</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">.</span>
├── ai-iot-app																	应用层（前台）
│   ├── ai-iot-app-monolith-boot												单体应用
│   ├── ai-iot-app-auth															授权认证应用
│   ├── ai-iot-app-open															对外开放应用
│   ├── ai-iot-app-platform-admin												平台管理应用
│   ├── ai-iot-app-smart-city													智慧城市应用
│   ├── ai-iot-app-smart-community												智慧社区应用
│   ├── ai-iot-app-smart-home													智慧家庭应用
│   └── ai-iot-app-tenantry-admin												租户管理应用
│       ├── ai-iot-app-tenantry-admin-boot										SpringBootApplication模块
│       ├── ai-iot-app-tenantry-admin-business									业务模块
│       └── ai-iot-app-tenantry-admin-controller								控制层模块
├── ai-iot-base																	基础层
│   ├── ai-iot-base-etcd														ETCD公共接口模块
│   ├── ai-iot-base-kafka														卡夫卡公共接口模块
│   ├── ai-iot-base-mongodb														MongoDB公共接口模块
│   ├── ai-iot-base-mysql														MySQL公共接口模块，如通用Mapper
│   └── ai-iot-base-redis														Redis公共接口模块
├── ai-iot-common																公共模块
│   ├── ai-iot-common-annotation												公共注解
│   ├── ai-iot-common-dto														公共数据模型
├── ai-iot-domain																领域层（中台）
│   ├── ai-iot-domain-account													账户领域服务
│   ├── ai-iot-domain-base														基础领域服务
│   ├── ai-iot-domain-device													设备领域服务
│   └── ai-iot-domain-rule														规则引擎领域服务
│       ├── ai-iot-domain-rule-adapter											基础层适配器模块
│       ├── ai-iot-domain-rule-boot												SpringBootApplication模块
│       ├── ai-iot-domain-rule-common											公共模块
│       ├── ai-iot-domain-rule-core												业务实现模块
│       └── ai-iot-domain-rule-service											业务接口模块
└── ai-iot-gateway																网关层（接入层）
    ├── ai-iot-gateway-api														http网关
    └── ai-iot-gateway-mqtt														mqtt网关
        ├── ai-iot-gateway-mqtt-adapter											基础层适配器模块
        ├── ai-iot-gateway-mqtt-boot											SpringBootApplication模块
        ├── ai-iot-gateway-mqtt-common											公共模块
        ├── ai-iot-gateway-mqtt-core											核心层模块
        └── ai-iot-gateway-mqtt-service										 	业务接口模块
</code></pre></div></div>

<p>  以上项目结构大致分为网关层、前台应用层、领域服务层和基础服务接口层，然后每一层又分为多个模块，大致有控制层模块、业务接口模块、业务核心模块、公共模块，应用启动模块。其中，值得注意的是，每一个项目有一个<strong><code class="language-plaintext highlighter-rouge">**-boot</code></strong>的模块，顾名思义，就是<code class="language-plaintext highlighter-rouge">SpringBootApplication</code>的启动模块，<code class="language-plaintext highlighter-rouge">ai-iot-app-monolith-boot</code>模块是将整个项目打包成单体应用的模块。</p>

<p>  这样的项目架构，一次打包就可以打包成单体和分布式两种项目，如果想要分布式，则分别启动每个项目的<strong><code class="language-plaintext highlighter-rouge">**-boot</code></strong>模块，即可作为<code class="language-plaintext highlighter-rouge">SpringCloud</code>微服务部署，如果想要单体，则只需将每一个<code class="language-plaintext highlighter-rouge">domain</code>项目的<code class="language-plaintext highlighter-rouge">core</code>模块和<code class="language-plaintext highlighter-rouge">service</code>模块，将每一个<code class="language-plaintext highlighter-rouge">app</code>项目的<code class="language-plaintext highlighter-rouge">controller</code>模块依赖到<code class="language-plaintext highlighter-rouge">ai-iot-app-monolith-boot</code>项目，即可作为单体项目部署。注意，在扫描包时，注意不要扫描非必要包，要精准扫描，避免注入非必要的<code class="language-plaintext highlighter-rouge">bean</code>。</p>

<h2 id="灵活的架构配置">灵活的架构配置</h2>

<hr />

<p>  配置，是软件设计领域的必备灵丹妙药，在无需修改任何代码的情况下，就可以让软件架构，软件能力按照需求快速上阵，何乐而不为呢？</p>

<p>  在微服务被推上架构设计神坛的当下，<code class="language-plaintext highlighter-rouge">SpringCloud</code>成为<code class="language-plaintext highlighter-rouge">java</code>领域微服务的事实标准。所以<code class="language-plaintext highlighter-rouge">SpringBoot</code>的<strong>条件装配</strong>（<a href="/blog/24#springboot-注解"><code class="language-plaintext highlighter-rouge">@Conditional</code></a>）将成为此段章节的主角。比如，在此项目中，我将服务是单体模式还是微服务模式，通过配置文件与条件装配结合的方式来灵活注入接口的<code class="language-plaintext highlighter-rouge">bean</code>，甚至抽象出多个自定义重复注解，以便在开发过程中方便理解和使用。</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cm">/**
 * 单体组件
 *
 * @author huangdayu create at 2021/3/8 15:19
 */</span>
<span class="nd">@Retention</span><span class="o">(</span><span class="nc">RetentionPolicy</span><span class="o">.</span><span class="na">RUNTIME</span><span class="o">)</span>
<span class="nd">@Documented</span>
<span class="nd">@ConditionalOnExpression</span><span class="o">(</span><span class="s">"'true'.equals('${ai-iot.monolith:false}')"</span><span class="o">)</span>
<span class="nd">@Component</span>
<span class="kd">public</span> <span class="nd">@interface</span> <span class="nc">MonolithComponent</span> <span class="o">{</span>


    <span class="nd">@AliasFor</span><span class="o">(</span><span class="n">annotation</span> <span class="o">=</span> <span class="nc">Component</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
    <span class="nc">String</span> <span class="nf">value</span><span class="o">()</span> <span class="k">default</span> <span class="s">""</span><span class="o">;</span>

<span class="o">}</span>
</code></pre></div></div>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cm">/**
 * 微服务接口
 *
 * @author huangdayu create at 2021/3/8 15:24
 */</span>
<span class="nd">@Retention</span><span class="o">(</span><span class="nc">RetentionPolicy</span><span class="o">.</span><span class="na">RUNTIME</span><span class="o">)</span>
<span class="nd">@Documented</span>
<span class="nd">@FeignClient</span>
<span class="kd">public</span> <span class="nd">@interface</span> <span class="nc">MicroserviceService</span> <span class="o">{</span>

    <span class="nd">@AliasFor</span><span class="o">(</span><span class="n">annotation</span> <span class="o">=</span> <span class="nc">FeignClient</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
    <span class="n">java</span><span class="o">.</span><span class="na">lang</span><span class="o">.</span><span class="na">String</span> <span class="nf">value</span><span class="o">()</span> <span class="k">default</span> <span class="s">""</span><span class="o">;</span>

    <span class="nd">@java</span><span class="o">.</span><span class="na">lang</span><span class="o">.</span><span class="na">Deprecated</span>
    <span class="nd">@AliasFor</span><span class="o">(</span><span class="n">annotation</span> <span class="o">=</span> <span class="nc">FeignClient</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
    <span class="n">java</span><span class="o">.</span><span class="na">lang</span><span class="o">.</span><span class="na">String</span> <span class="nf">serviceId</span><span class="o">()</span> <span class="k">default</span> <span class="s">""</span><span class="o">;</span>

    <span class="nd">@AliasFor</span><span class="o">(</span><span class="n">annotation</span> <span class="o">=</span> <span class="nc">FeignClient</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
    <span class="n">java</span><span class="o">.</span><span class="na">lang</span><span class="o">.</span><span class="na">String</span> <span class="nf">contextId</span><span class="o">()</span> <span class="k">default</span> <span class="s">""</span><span class="o">;</span>

    <span class="nd">@AliasFor</span><span class="o">(</span><span class="n">annotation</span> <span class="o">=</span> <span class="nc">FeignClient</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
    <span class="n">java</span><span class="o">.</span><span class="na">lang</span><span class="o">.</span><span class="na">String</span> <span class="nf">name</span><span class="o">()</span> <span class="k">default</span> <span class="s">""</span><span class="o">;</span>

    <span class="nd">@AliasFor</span><span class="o">(</span><span class="n">annotation</span> <span class="o">=</span> <span class="nc">FeignClient</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
    <span class="n">java</span><span class="o">.</span><span class="na">lang</span><span class="o">.</span><span class="na">String</span> <span class="nf">qualifier</span><span class="o">()</span> <span class="k">default</span> <span class="s">""</span><span class="o">;</span>

    <span class="nd">@AliasFor</span><span class="o">(</span><span class="n">annotation</span> <span class="o">=</span> <span class="nc">FeignClient</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
    <span class="n">java</span><span class="o">.</span><span class="na">lang</span><span class="o">.</span><span class="na">String</span> <span class="nf">url</span><span class="o">()</span> <span class="k">default</span> <span class="s">""</span><span class="o">;</span>

    <span class="nd">@AliasFor</span><span class="o">(</span><span class="n">annotation</span> <span class="o">=</span> <span class="nc">FeignClient</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
    <span class="kt">boolean</span> <span class="nf">decode404</span><span class="o">()</span> <span class="k">default</span> <span class="kc">false</span><span class="o">;</span>

    <span class="nd">@AliasFor</span><span class="o">(</span><span class="n">annotation</span> <span class="o">=</span> <span class="nc">FeignClient</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
    <span class="n">java</span><span class="o">.</span><span class="na">lang</span><span class="o">.</span><span class="na">Class</span><span class="o">&lt;?&gt;[]</span> <span class="n">configuration</span><span class="o">()</span> <span class="k">default</span> <span class="o">{};</span>

    <span class="nd">@AliasFor</span><span class="o">(</span><span class="n">annotation</span> <span class="o">=</span> <span class="nc">FeignClient</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
    <span class="n">java</span><span class="o">.</span><span class="na">lang</span><span class="o">.</span><span class="na">Class</span><span class="o">&lt;?&gt;</span> <span class="n">fallback</span><span class="o">()</span> <span class="k">default</span> <span class="kt">void</span><span class="o">.</span><span class="na">class</span><span class="o">;</span>

    <span class="nd">@AliasFor</span><span class="o">(</span><span class="n">annotation</span> <span class="o">=</span> <span class="nc">FeignClient</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
    <span class="n">java</span><span class="o">.</span><span class="na">lang</span><span class="o">.</span><span class="na">Class</span><span class="o">&lt;?&gt;</span> <span class="n">fallbackFactory</span><span class="o">()</span> <span class="k">default</span> <span class="kt">void</span><span class="o">.</span><span class="na">class</span><span class="o">;</span>

    <span class="nd">@AliasFor</span><span class="o">(</span><span class="n">annotation</span> <span class="o">=</span> <span class="nc">FeignClient</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
    <span class="n">java</span><span class="o">.</span><span class="na">lang</span><span class="o">.</span><span class="na">String</span> <span class="nf">path</span><span class="o">()</span> <span class="k">default</span> <span class="s">""</span><span class="o">;</span>

    <span class="nd">@AliasFor</span><span class="o">(</span><span class="n">annotation</span> <span class="o">=</span> <span class="nc">FeignClient</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
    <span class="kt">boolean</span> <span class="nf">primary</span><span class="o">()</span> <span class="k">default</span> <span class="kc">true</span><span class="o">;</span>

<span class="o">}</span>
</code></pre></div></div>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cm">/**
 * 微服务熔断组件
 *
 * @author huangdayu create at 2021/3/8 15:24
 */</span>
<span class="nd">@Retention</span><span class="o">(</span><span class="nc">RetentionPolicy</span><span class="o">.</span><span class="na">RUNTIME</span><span class="o">)</span>
<span class="nd">@Documented</span>
<span class="nd">@ConditionalOnExpression</span><span class="o">(</span><span class="s">"'false'.equals('${ai-iot.monolith:false}')"</span><span class="o">)</span>
<span class="nd">@Component</span>
<span class="kd">public</span> <span class="nd">@interface</span> <span class="nc">MicroserviceFallback</span> <span class="o">{</span>

    <span class="nd">@AliasFor</span><span class="o">(</span><span class="n">annotation</span> <span class="o">=</span> <span class="nc">Component</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
    <span class="nc">String</span> <span class="nf">value</span><span class="o">()</span> <span class="k">default</span> <span class="s">""</span><span class="o">;</span>

<span class="o">}</span>
</code></pre></div></div>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cm">/**
 * 微服务接口实现组件
 *
 * @author huangdayu create at 2021/3/8 15:24
 */</span>
<span class="nd">@Retention</span><span class="o">(</span><span class="nc">RetentionPolicy</span><span class="o">.</span><span class="na">RUNTIME</span><span class="o">)</span>
<span class="nd">@Documented</span>
<span class="nd">@ConditionalOnExpression</span><span class="o">(</span><span class="s">"'false'.equals('${ai-iot.monolith:false}')"</span><span class="o">)</span>
<span class="nd">@Primary</span> <span class="c1">// 多例时，首选该bean，因为 fallback bean 也存在容器中</span>
<span class="nd">@RestController</span>
<span class="nd">@RequestMapping</span>
<span class="kd">public</span> <span class="nd">@interface</span> <span class="nc">MicroserviceComponent</span> <span class="o">{</span>

    <span class="nd">@AliasFor</span><span class="o">(</span><span class="n">annotation</span> <span class="o">=</span> <span class="nc">RequestMapping</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
    <span class="nc">String</span> <span class="nf">name</span><span class="o">()</span> <span class="k">default</span> <span class="s">""</span><span class="o">;</span>

    <span class="nd">@AliasFor</span><span class="o">(</span><span class="n">annotation</span> <span class="o">=</span> <span class="nc">RequestMapping</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
    <span class="nc">String</span> <span class="nf">path</span><span class="o">()</span> <span class="k">default</span> <span class="s">""</span><span class="o">;</span>

    <span class="nd">@AliasFor</span><span class="o">(</span><span class="n">annotation</span> <span class="o">=</span> <span class="nc">RequestMapping</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
    <span class="nc">RequestMethod</span><span class="o">[]</span> <span class="nf">method</span><span class="o">()</span> <span class="k">default</span> <span class="o">{};</span>

    <span class="nd">@AliasFor</span><span class="o">(</span><span class="n">annotation</span> <span class="o">=</span> <span class="nc">RequestMapping</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
    <span class="nc">String</span><span class="o">[]</span> <span class="nf">params</span><span class="o">()</span> <span class="k">default</span> <span class="o">{};</span>

    <span class="nd">@AliasFor</span><span class="o">(</span><span class="n">annotation</span> <span class="o">=</span> <span class="nc">RequestMapping</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
    <span class="nc">String</span><span class="o">[]</span> <span class="nf">headers</span><span class="o">()</span> <span class="k">default</span> <span class="o">{};</span>

    <span class="nd">@AliasFor</span><span class="o">(</span><span class="n">annotation</span> <span class="o">=</span> <span class="nc">RequestMapping</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
    <span class="nc">String</span><span class="o">[]</span> <span class="nf">consumes</span><span class="o">()</span> <span class="k">default</span> <span class="o">{};</span>

    <span class="nd">@AliasFor</span><span class="o">(</span><span class="n">annotation</span> <span class="o">=</span> <span class="nc">RequestMapping</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
    <span class="nc">String</span><span class="o">[]</span> <span class="nf">produces</span><span class="o">()</span> <span class="k">default</span> <span class="o">{};</span>
<span class="o">}</span>
</code></pre></div></div>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cm">/**
 * 查询设备信息接口
 *
 * @author huangdayu create at 2021/3/8 10:51
 */</span>
<span class="nd">@MicroserviceService</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"ai-iot-domain-device-boot"</span><span class="o">,</span>
        <span class="n">contextId</span> <span class="o">=</span> <span class="s">"ai-iot-domain-device-boot-deviceDetailsService"</span><span class="o">,</span>
        <span class="n">path</span> <span class="o">=</span> <span class="s">"/deviceDetailsService"</span><span class="o">,</span>
        <span class="n">fallback</span> <span class="o">=</span> <span class="nc">DeviceDetailsService</span><span class="o">.</span><span class="na">DeviceDetailsServiceFallbackImpl</span><span class="o">.</span><span class="na">class</span>
<span class="o">)</span>
<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">DeviceDetailsService</span> <span class="o">{</span>


    <span class="nd">@GetMapping</span><span class="o">(</span><span class="s">"/getDeviceDetails/{id}"</span><span class="o">)</span>
    <span class="nc">DeviceDetailsDTO</span> <span class="nf">getDeviceDetails</span><span class="o">(</span><span class="nd">@PathVariable</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"id"</span><span class="o">)</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">);</span>

    <span class="nd">@MicroserviceFallback</span>
    <span class="kd">class</span> <span class="nc">DeviceDetailsServiceFallbackImpl</span> <span class="kd">implements</span> <span class="nc">DeviceDetailsService</span> <span class="o">{</span>

        <span class="nd">@Override</span>
        <span class="kd">public</span> <span class="nc">DeviceDetailsDTO</span> <span class="nf">getDeviceDetails</span><span class="o">(</span><span class="nc">Long</span> <span class="n">id</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
        <span class="o">}</span>

    <span class="o">}</span>

<span class="o">}</span>
</code></pre></div></div>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cm">/**
 * 查询设备信息接口的实现（单体模式注入）
 *
 * @author huangdayu create at 2021/3/8 17:53
 */</span>
<span class="nd">@MonolithComponent</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">DeviceDetailsServiceImpl</span> <span class="kd">implements</span> <span class="nc">DeviceDetailsService</span> <span class="o">{</span>

    <span class="cm">/**
     * 查询设备信息接口的实现（微服务模式注入）
     */</span>
    <span class="nd">@MicroserviceComponent</span><span class="o">(</span><span class="n">path</span> <span class="o">=</span> <span class="s">"/deviceDetailsService"</span><span class="o">)</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">DeviceDetailsServiceRpcImpl</span> <span class="kd">extends</span> <span class="nc">DeviceDetailsServiceImpl</span> <span class="kd">implements</span> <span class="nc">DeviceDetailsService</span> <span class="o">{</span>

    <span class="o">}</span>

    <span class="nd">@Autowired</span>
    <span class="kd">private</span> <span class="nc">ProductDetailsService</span> <span class="n">productDetailsService</span><span class="o">;</span>


    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="nc">DeviceDetailsDTO</span> <span class="nf">getDeviceDetails</span><span class="o">(</span><span class="nc">Long</span> <span class="n">id</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">DeviceDetailsDTO</span><span class="o">(</span><span class="n">id</span><span class="o">,</span> <span class="s">"deviceName_"</span> <span class="o">+</span> <span class="n">id</span><span class="o">,</span> <span class="n">productDetailsService</span><span class="o">.</span><span class="na">getProductDetails</span><span class="o">(</span><span class="n">id</span><span class="o">));</span>
    <span class="o">}</span>


<span class="o">}</span>
</code></pre></div></div>

<p>  如果读者有一定的<code class="language-plaintext highlighter-rouge">SpringCloud</code>开发经验，则一眼看出此番操作的精髓：抽象一个接口，只有一个真正的业务实现，通过读取模式配置，注入不同的<code class="language-plaintext highlighter-rouge">bean</code>，以实现单体下调用本地接口，在微服务下，调用远程接口，也达到了资源的最优利用。</p>

<h2 id="灵活的组件隔离">灵活的组件隔离</h2>

<hr />

<p>  开源框架、组件、中间件是每一个项目都逃不过的技术话题。也总所周知，软件世界是千变万化的，今天还热门的框架也许明天就淘汰了，今天还持续维护的项目也许明天就停止维护了，所以，以不变应万变才是永恒的真理。无论是外部存储，还是消息中间件，都在其框架和核心业务之间抽象一层接口，以实现对框架和中间件的无缝切换，核心业务不需要做任何的修改，如果时间允许，还可以做成灵活配置的形式。</p>

<p>  所以，才在上述项目中设计了<code class="language-plaintext highlighter-rouge">adapter</code>模块。</p>

<h2 id="总结">总结</h2>

<p>  之前，我觉得架构应该是实用型的，而今，我觉得还有在前面加上灵活型。</p>

<p>  总之，一句话，<strong>以不变应万变</strong>，是架构应该追求的目标。</p>


</article><br/>
<br/>
<p style="display: block;text-align:center;">©2012-2022 huangdayu.cn(大鱼叔叔的博客) 版权所有，未经授权，不得转载。</p>
<br/>
<a style="display: block;text-align:right;" href="/">Back</a>
      </div>
    </main>
  </body>
</html>